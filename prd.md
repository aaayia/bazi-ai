# 智能命理助手小程序产品需求文档 (PRD)

| 项目名称 | 智能命理助手 (Project DeepDestiny) |
| :--- | :--- |
| **版本号** | V1.0 (MVP) |
| **文档状态** | 正式发布 |
| **撰写日期** | 2023-10 |
| **优先级** | P0 |
| **参考设计** | 水墨禅意风格 (基于参考UI图) |

---

## 1. 项目背景与目标 (Project Background)
本产品旨在开发一款基于微信小程序的智能命理分析工具。利用 `lunar` 算法库进行精准的八字排盘，结合 **DeepSeek API** 的推理能力，为用户提供“既懂传统国学，又懂现代心理”的个性化解读。

**MVP 核心目标**：完成从“用户输入”到“排盘计算”再到“AI 解读”的完整闭环，并通过水墨国风 UI 建立产品调性。

---

## 2. UI/UX 设计规范 (UI/UX Specifications)

基于提供的参考图片，确定本产品的视觉语言：

*   **整体风格**：新中式、水墨禅意、极简。
*   **核心色板**：
    *   **主色 (Primary)**：`#1E9E8D` (青绿色，参考图中的核心按钮色)。
    *   **背景色 (Background)**：浅米色宣纸纹理或淡入的水墨山水图（参考图1）。
    *   **文字色**：`#333333` (正文)、`#666666` (次级信息)。
*   **字体**：系统默认字体，标题处建议引入类似“方正宋刻本”或“楷体”的 WebFont 以增强国风感。
*   **卡片风格**：半透明磨砂白底，圆角 `12px`，轻微阴影，营造悬浮感。

---

## 3. 产品信息架构 (Information Architecture)

```mermaid
    A[首页/输入页] -->|点击开始计算| B[加载过渡页]
    B -->|计算完成| C[结果展示页]
    C -->|点击AI八字解读| D[AI 推理浮层/弹窗]
    C -->|点击重新计算| A
```


好的，作为产品经理，我已结合你的需求描述以及提供的三张参考设计图（水墨禅意风格、输入页布局、结果页布局），为你撰写了这份详细的 PRD（产品需求文档）。
这份文档侧重于 MVP（最小可行性产品） 的落地，确保开发团队能快速理解 UI 规范、交互逻辑和底层算法要求。
以下是 prd.md 的内容：
code
Markdown
# 智能命理助手小程序产品需求文档 (PRD)

| 项目名称 | 智能命理助手 (Project DeepDestiny) |
| :--- | :--- |
| **版本号** | V1.0 (MVP) |
| **文档状态** | 正式发布 |
| **撰写日期** | 2023-10 |
| **优先级** | P0 |

---

## 1. 项目背景与目标
本产品旨在开发一款基于微信小程序的智能命理分析工具。利用 `lunar` 算法库进行精准的八字排盘，结合 **DeepSeek API** 的推理能力，为用户提供“既懂传统国学，又懂现代心理”的个性化解读。

**MVP 核心目标**：完成从“用户输入”到“排盘计算”再到“AI 解读”的完整闭环，并通过水墨国风 UI 建立产品调性。

---

## 2. UI/UX 设计规范 (参考设计图)

基于提供的参考图片，确定本产品的视觉语言：

*   **整体风格**：新中式、水墨禅意、极简。
*   **核心色板**：
    *   **主色 (Primary)**：`#1E9E8D` (参考图中的青绿色按钮，用于核心操作)。
    *   **背景色 (Background)**：浅米色宣纸纹理或淡入的水墨山水图（参考图1）。
    *   **文字色**：`#333333` (正文)、`#666666` (次级信息)。
*   **字体**：系统默认字体，但在标题处建议引入类似“方正宋刻本”或“楷体”的 WebFont（若包体允许）以增强国风感。
*   **卡片风格**：半透明磨砂白底，圆角 `12px`，轻微阴影。

---

## 3. 产品信息架构 (IA)

```mermaid
graph TD
    A[首页/输入页] -->|点击开始计算| B[加载过渡页]
    B -->|计算完成| C[结果展示页]
    C -->|点击八字解读| D[AI 推理浮层/弹窗]
    C -->|点击重新计算| A

 ```
 --- 

## 4. 详细功能需求
 ### 4.1 首页 / 输入模块
页面描述：参考提供的“输入页”截图。背景为淡雅的水墨山水，中段展示禅意插画（如打坐人物），下段为输入表单。

| 元素  |	交互逻辑/规则 |	备注 | 
| :------------- | :------------------------------- | :------------------------------------------------------ |
| 顶部标题 |	静态展示“查生辰”或自定义 App Name。	导航栏背景透明。| 
| 出生日期输入框 |	点击唤起微信原生 DatePicker (mode="date")。|	必填，默认显示“请选择出生日期 (阳历)”。| 
| 出生时间输入框	| 点击唤起微信原生 Picker (range=0-23及"不详")。 |	必填，默认显示“请选择出生时辰”。| 
| 开始计算按钮 |	1. 校验输入是否为空。<br>2. 若通过，跳转至结果页。<br>3.  | 样式：青绿色胶囊按钮，文案“开始计算”。	悬浮底部或表单下方。| 

## 4.2 核心算法模块 (本地/云函数)
说明：此部分不调用 DeepSeek，而是使用标准算法库（推荐 lunar-javascript）进行确定性计算，以保证排盘准确无误。
* 输入：阳历年、月、日、时。
*  处理逻辑：
    *  转农历：将阳历转为农历日期（例：二〇二五年十月初一）。
    * 排八字：计算年柱、月柱、日柱、时柱（例：乙巳 丁亥 癸巳 壬子）。
    * 算五行：根据天干地支对应关系，统计金木水火土的数量。
    * 判缺失：若某元素数量为 0，则标记为“缺”。
    *  定生肖：基于立春计算生肖。

* 输出数据结构 (JSON)：
code
```JSON
{
  "lunar": "二〇二五年十月初一",
  "bazi": ["乙巳", "丁亥", "癸巳", "壬子"],
  "wuxing": ["木火", "火水", "水火", "水水"],
  "missing": ["金", "土"], // 若无缺失则为空数组
  "zodiac": "蛇"
}
```
## 4.3 结果展示页
页面描述：参考提供的“计算结果”截图。列表式展示硬性数据，底部引导用户查看 AI 解读。

|字段/模块 |	显示规则 |	UI 参考|
| :------------- | :------------------------------- | :------------------------------------------------------ |
|公历生日	|回显用户输入的阳历日期 (yyyy-MM-dd)。	|列表行，右对齐。|
|农历生日	|显示算法转换后的农历文本。	|列表行，右对齐。|
|天干地支	|显示四柱八字。	|列表行，格式如“乙巳-丁亥-癸巳-壬子”。|
|所属五行	|显示对应五行属性。	|列表行，格式如“木火-火水-水火-水水”。|
|五行缺啥	|高亮显示。若无缺失显示“五行俱全”。	|字体颜色可加深或用警示色。|
|所属生肖	|显示生肖文字。	|右对齐。|
|底部操作区	|包含两个按钮：<br>1. AI 八字解读 (主按钮，青绿色)。<br>2. 重新计算 (次级按钮，线框)。	|按钮需醒目，参考截图布局。|
|广告位	|嵌入在列表下方或底部固定。	|预留 Banner 广告位。|

## 4.4 AI 推理模块 (DeepSeek 集成)
触发场景：用户在结果页点击“AI 八字解读”按钮。

* 交互状态：
    * 点击后弹出半屏弹窗或 Loading 提示：“AI 正在参悟天机...”（参考截图中的 Loading 条）。
    * 调用后端接口。
* Prompt 策略 (后端封装)：
    * Role: "你是一位精通《三命通会》与现代心理学的国学大师，语气温和、客观、充满智慧。"
    * Input: 传入 4.2 中计算出的 JSON 数据（重点传入日主、五行分布、缺失元素）。
    * Task:
        用通俗易懂的语言分析该八字的性格特征 (100字以内)。
        针对五行缺失给出具体的补救建议（颜色、饰品、行为习惯）(100字以内)。
        给出一句古诗词作为人生寄语。
* 输出展示：
    在结果页下方展开，或弹窗展示 Markdown 渲染后的文本。
    支持打字机效果（流式输出）以增强“实时计算”的体感。

##  5. 数据埋点需求 (暂时不做)
UV/PV：首页访问量、结果页访问量。
点击率 (CTR)：
“开始计算”按钮点击数。
“AI 八字解读”按钮点击数（核心转化指标）。
底部广告点击数。 

##  6. 技术栈建议
* 前端：微信小程序原生框架 (WXML, WXSS, TS) 或 Uni-app (Vue3)。
* 算法库：lunar-javascript (前端直接引入，减小服务器压力)。
* 后端：微信云开发 (Cloud Functions) —— 必须用于存放 DeepSeek API Key，严禁在前端暴露 Key。 

## 7. 验收标准
* 准确性：输入的阳历转农历、八字排盘必须与主流万年历一致。
* 完整性：五行缺失判断逻辑正确（例如：四个柱子包含的五行都没金，必须提示缺金）。
* AI 响应：DeepSeek 接口调用成功，能在 5-10秒内返回文案；若超时需有友好提示。
* UI 还原：必须复刻参考图的水墨风格，按钮颜色一致，无明显布局错乱。